<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>QH2011e-TCNH-UEB</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Oswald:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div style="padding:12px 16px; display:flex; justify-content:flex-end; align-items:center; gap:12px;">
      <button id="music-toggle" aria-pressed="false" aria-label="Bật / tắt nhạc nền" style="padding:6px 10px; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer;">Bật nhạc</button>
      <audio id="bg-music" loop preload="auto">
        <source src="data/music/background.mp3" type="audio/mpeg">
        <!-- Nếu bạn có file .ogg, thêm dưới đây để tăng tương thích -->
        <!-- <source src="data/music/background.ogg" type="audio/ogg"> -->
        Trình duyệt của bạn không hỗ trợ thẻ audio.
      </audio>
    </div>

    <script>
      // Thiết lập nút Play/Pause cho bg-music
      (function () {
        const audio = document.getElementById('bg-music');
        const btn = document.getElementById('music-toggle');

        // Cập nhật trạng thái nút theo audio
        function updateButton() {
          if (audio && btn) {
            if (audio.paused) {
              btn.textContent = 'Bật nhạc';
              btn.setAttribute('aria-pressed', 'false');
            } else {
              btn.textContent = 'Tắt nhạc';
              btn.setAttribute('aria-pressed', 'true');
            }
          }
        }

        // Thử autoplay (nhiều trình duyệt sẽ chặn nếu không có tương tác)
        // Nếu bị chặn thì người dùng có thể nhấn nút để bật.
        window.addEventListener('load', async () => {
          try {
            // Không đặt muted ở đây — thử phát để xem nếu trình duyệt cho phép
            await audio.play();
          } catch (err) {
            // Autoplay bị chặn — giữ ở trạng thái paused
            // Bạn có thể thử audio.muted = true; audio.play(); để autoplay im lặng
            // rồi unmute sau khi người dùng tương tác.
            // console.log('Autoplay blocked:', err);
          }
          updateButton();
        });

        btn.addEventListener('click', async () => {
          try {
            if (audio.paused) {
              await audio.play();
            } else {
              audio.pause();
            }
          } catch (err) {
            console.warn('Không thể phát/paus nhạc:', err);
          }
          updateButton();
        });

        // Nếu audio kết thúc (nên không xảy ra vì loop), cập nhật nút
        audio.addEventListener('play', updateButton);
        audio.addEventListener('pause', updateButton);
      })();
    </script>
    <div class="slideshow">
      <div class="progress-bar indicator"></div>
      <div id="card-stage" class="card-stage"></div>     

      <div id="pagination" class="pagination">
        <div class="progress-track" aria-hidden="true">
          <div class="progress-track-background">
            <div class="progress-fill"></div>
          </div>
        </div>
        <div id="slide-numbers" class="slide-index" aria-hidden="true"></div>
        <button class="pause-button" type="button" aria-pressed="false" aria-label="Pause slideshow" title="Pause slideshow"> </button>
      </div>

      <div class="transition-cover cover" aria-hidden="true"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js" defer></script>
    <script src="script.js" defer></script>
  </body>
</html>
